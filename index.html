<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Un Messaggio per Rachele</title>
    
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>

    <style>
        body {
            background-color: #0d0d0d;
            color: #e0e0e0;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }
        #container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        /* Usiamo <pre> per l'arte ASCII, che preserva spazi e a-capo */
        #ascii-art {
            font-size: 10px; /* Riduciamo la dimensione per farlo stare meglio */
            line-height: 1.0;
            text-align: left;
        }
        #message {
            font-size: 18px;
            margin-top: 15px;
            height: 50px; /* Altezza fissa per evitare salti */
            text-align: center;
        }
        #finale-container {
            display: none;
            text-align: center;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    
    <div id="container">
        <pre id="ascii-art">Inizializzazione...</pre>
        <div id="message"></div>
        <div id="finale-container">
            <span id="messaggio-finale"></span>
            <button py-click="chiudi_finestra()">Premi qui per finire</button>
        </div>
    </div>

    <py-script>
import asyncio
from js import document

# --- Elementi della pagina ---
ascii_div = document.getElementById("ascii-art")
message_div = document.getElementById("message")
finale_container = document.getElementById("finale-container")
messaggio_finale_span = document.getElementById("messaggio-finale")

# --- CONFIGURAZIONE ---
PAUSA_LENTA = 3
PAUSA_LENTISSIMA = 5
VELOCITA_DISEGNO = 0.02
PAUSA_PUNTINI = 0.4

# Messaggi
MESSAGGIO_INIZIALE = f"...e ora, un messaggio dalla nostra sponsor."
MESSAGGIO_GESTACCIO_INNOCENTE = "Cosa c'è? Ti sto solo... fissando. Sì, esatto."
MESSAGGIO_RESIGNATO = "Uff, e va bene! Non volevo essere scortese!"
MESSAGGIO_SALUTO_FINALE = "Ecco, contenta adesso? Un saluto. Solo per te."
MESSAGGIO_FINALE_TESTO = "Bene, abbiamo finito. Puoi... puoi andare ora."

# --- GRAFICA ---
RACHELE_TI_AMO_ASCII = r"""
                         ,--,      ,--,                                                    ,----,       ,----,                   
        ,--,          ,---.'|   ,---.'|       ,----..                  ,--.              ,/   .`|     ,/   .`|                   
      ,--.'|    ,---,.|   | :   |   | :      /   /   \             ,--/  /|   ,---,    ,`   .'  :   ,`   .'  :                   
   ,--,  | :  ,'  .' |:   : |   :   : |     /   .     :         ,---,': / ',`--.' |  ;    ;     / ;    ;     /      ,---,        
,---.'|  : ',---.'   ||   ' :   |   ' :    .   /   ;.  \        :   : '/ / |   :  :.'___,/    ,'.'___,/    ,'      /_ ./|        
|   | : _' ||   |   .';   ; '   ;   ; '   .   ;   /  ` ;        |   '   ,  :   |  '|    :     | |    :     | ,---, |  ' :        
:   : |.'  |:   :  |-,'   | |__ '   | |__ ;   |  ; \ ; |        '   |  /   |   :  |;    |.';  ; ;    |.';  ;/___/ \.  : |        
|   ' '  ; ::   |  ;/||   | :.'||   | :.'||   :  | ; | '        |   ;  ;   '   '  ;`----'  |  | `----'  |  | .  \  \ ,' '        
'   |  .'. ||   :   .''   :    ;'   :    ;.   |  ' ' ' :        :   '   \  |   |  |    '   :  ;     '   :  ;  \  ;  `  ,'        
|   | :  | '|   |  |-,|   |  ./ |   |  ./ '   ;  \; /  |        |   |    ' '   :  ;    |   |  '     |   |  '   \  \    '         
'   : |  : ;'   :  ;/|;   : ;   ;   : ;    \   \  ',  /         '   : |.  \|   |  '    '   :  |     '   :  |    '  \   |         
|   | '  ,/ |   |    \|   ,/    |   ,/      ;   :    /          |   | '_\.''   :  |    ;   |.'      ;   |.'      \  ;  ;         
;   : ;--'  |   :   .''---'     '---'        \   \ .'           '   : |    ;   |.'     '---'        '---'         :  \  \        
|   ,/      |   | ,'                          `---`        ,---,;   |,'    '---',--,    ,--,                       \  ' ;        
'---'       `----'                                       ,--.' |'---'         ,--.'|  ,--.'|                        `--`         
                                                         |  |  :              |  | :  |  | :     ,---.                           
                 .--.--.                                 :  :  :              :  : '  :  : '    '   ,'\                          
                /  /    '    ,--.--.        .--,         :  |  |,--.   ,---.  |  ' |  |  ' |   /   /   |                         
               |  :  /`./   /       \     /_ ./|         |  :  '   |  /     \ '  | |  '  | |  .   ; ,. :                         
               |  :  ;_    .--.  .-. | , ' , ' :         |  |   /' : /    /  ||  | :  |  | :  '   | |: :                         
                \  \    `.  \__\/: . ./___/ \: |         '  :  | | |.    ' / |'  : |__'  : |__'   | .; :                         
                 `----.   \ ," .--.; | .  \  ' |         |  |  ' | :'   ;   /||  | '.'|  | '.'|   :    |                         
                /  /`--'  //  /  ,.  |  \  ;   :         |  :  :_:,''   |  / |;  :    ;  :    ;\   \  /                          
               '--'.     /;  :   .'   \  \  \  ;         |  | ,'    |   :    ||  ,   /|  ,   /  `----'                           
                 `--'---' |  ,     .-./   :  \  \        `--''       \   \  /  ---`-'  ---`-'                                    
                           `--`---'        \  ' ;                     `----'                                                     
                                            `--`                                                                                 
"""

HELLO_KITTY_GESTACCIO = r"""
===========================================================================================================
===========================================================================================================
===========================================================================================================
=========================================================-:::--============================================
======================================================-::-*##+-.:-=========================================
==================:.......::-========================.:*@@#++%@@+.:========--:......:-=====================
================-.:+@@@@@@#=:..:-==================-.-@@*======*@%-.===-:..:-+#@@@@@=:.-===================
===============:.-@@@*+*#%@@@@%+-..--===---:::::...:*@#=========+%@-...:=#@@@@%#**#@@%-.:==================
==============-.-@@*.......:-*@@@@#=....:-=*##%%%%%@@+===========+%@=*@@@@*=:......:#@@:.-=================
==============.:#@#............:=%@@@@@@@@@@@@@%%%@@+==============@@@@=:...........:%@%.:-================
=============-.-@@=................=%@#+.........#@*=======+%@@@@@%*@%-:.............+@@-:-================
=============-.=@@-.............................-@%=======*@%+==*@@@@@@@@#-.::::----:=@@=.-================
=============-.-@@-.............................+@#=======%@*=*@@*======+#@@@@@%%##%@@@@+.:================
=============-.:@@+.............................=@#=======#@%#@@==========+@%==========*@*.:===============
==============::*@%.............................:@%========*@@@+===========#@@*+========#%-.===============
==============-.-%@#=+-..........................=@%+========%@============#@*#@#=======%%-:===============
===============-.+@@@#:...........................-#@@%%%%%@@@@@==========+@%==#@+=====*@+.-===============
===============.:#@@=................................:::::::..=@@*=======*@%+=*@#=====*@*.:================
==============.:#@@:............................................+@@@@%@@@@*%%%#======*@#.:=================
=============:.#@%-................................................:=+#@+===========#@@@::-================
============:.*@@=....................................................:#@*========#@%*@@*.-================
===========-.-@@*.......................................................=@@%*+*@@@#:..%@@-:================
===========:.#@@:..........................................................-++=:......=@@*.-===============
===========:-%@*.......................................................................%@%-:===============
==========-.=@@=.......................................................................=@@=.-==============
=======---:.+@@:........................................................................@@*...::--=========
=-:.:------=#@@----...........--:.....................................:-:...........:--=%@%*++==---:::=====
=::*##+==+==#@@+=++-........-@@@@=...................................#@@@%:.........-==+@@%====+==**-.-====
=-:....:--:.+@@=............%@@@@@..................................=@@@@@+............:@@*:-###*:..:-=====
===========.-%@*............#@@@@@..................................-@@@@@=............=@@*##+:============
========--:..#@@=---........:%@@@-...............:---................+@@@+..........:--  #@ =======.-====
======-.-=+*##%%%++-...........:...............+@#***@*:............................=+#  #@ *##+===-======
======-.=+--:.:@@#:...........................-%#----+@-.............................*#%%% @@@@@-.:====
======:.-@@@@@@@@@%............................:#@@@@%:.........................:**:*@@@@@........@@@@==
====:.+@@%=:....-#@@**##=.......................................................:+%%%@@#............=@@=.:==
==-::%@*:......:=*#%@@*:.......................................................:=@@@@@+.............- @@=.-=
==:.%@*......=*#*-:.=@@@#:...................................................:#@@@+-@%-..............*@#.:=
=-:-@@-...:*##-......+@@@@@#:............................................:=%@@@%=..:@#:..............=@%::=
=-:-@@:...++-........=@#.=#@@@@*=-:................................:-=*%@@@@#=..:-::%@=.............:%@*.-=
==::@@=.............:#@+....-+#@@@@@%#*+=-:..............:-=++*#%@@@@@@%*=:.:--===-.=@@-...........:*@%::==
==-.=@@=............*@#:.===-:..::-+#@@@@@@@@@@@@@@@@@@@@@@@@@@@%*=-::..:-=========-.-@@#-........=@@*.:-==
===-.-@@#:........=@@*:.=========-:........:::--------:::........::-=================:.=@@@@#*#%@@@#-.:====
=====:.=%@@@#**#@@@#:.:===================------::::------============================-:.:-*###*=:.:-======
=======-::-+***+=-..:-====================================================================--::::--=========
===========--::---=========================================================================================
===========================================================================================================
===========================================================================================================
"""

HELLO_KITTY_SALUTO = r"""
===========================================================================================================
===========================================================================================================
===========================================================================================================
=========================================================-:::--============================================
======================================================-::-*##+-.:-=========================================
==================:.......::-========================.:*@@#++%@@+.:========--:......:-=====================
================-.:+@@@@@@#=:..:-==================-.-@@*======*@%-.===-:..:-+#@@@@@=:.-===================
===============:.-@@@*+*#%@@@@%+-..--===---:::::...:*@#=========+%@-...:=#@@@@%#**#@@%-.:==================
==============-.-@@*.......:-*@@@@#=....:-=*##%%%%%@@+===========+%@=*@@@@*=:......:#@@:.-=================
==============.:#@#............:=%@@@@@@@@@@@@@%%%@@+==============@@@@=:...........:%@%.:-================
=============-.-@@=................=%@#+.........#@*=======+%@@@@@%*@%-:.............+@@-:-================
=============-.=@@-.............................-@%=======*@%+==*@@@@@@@@#-.::::----:=@@=.-================
=============-.-@@-.............................+@#=======%@*=*@@*======+#@@@@@%%##%@@@@+.:================
=============-.:@@+.............................=@#=======#@%#@@==========+@%==========*@*.:===============
==============::*@%.............................:@%========*@@@+===========#@@*+========#%-.===============
==============-.-%@#=+-..........................=@%+========%@============#@*#@#=======%%-:===============
===============-.+@@@#:...........................-#@@%%%%%@@@@@==========+@%==#@+=====*@+.-===============
===============.:#@@=................................:::::::..=@@*=======*@%+=*@#=====*@*.:================
==============.:#@@:............................................+@@@@%@@@@*%%%#======*@#.:=================
=============:.#@%-................................................:=+#@+===========#@@@::-================
============:.*@@=....................................................:#@*========#@%*@@*.-================
===========-.-@@*.......................................................=@@%*+-..*@@@#:.%@@-:================
===========:.#@@:..........................................................-++=:......=@@*.-===============
===========:-%@*.......................................................................%@%-:===============
==========-.=@@=.......................................................................=@@=.-==============
=======---:.+@@:........................................................................@@*...::--=========
=-:.:------=#@@----...........--:.....................................:-:...........:--=%@%*++==---:::=====
=::*##+==+==#@@+=++-........-@@@@=...................................#@@@%:.........-==+@@%====+==**-.-====
=-:....:--:.+@@=............%@@@@@..................................=@@@@@+............:@@*:-###*:..:-=====
===========.-%@*............#@@@@@..................................-@@@@@=............=@@# @@@@@%::======
========--:..#@@=---........:%@@@-...............:---................+@@@+..........:--=@@#@....@@=.-====
======-.-=+*##%%%++-...........:...............+@#***@*:............................=+#  # @....@-======
======-.=+--:.:@@#:...........................-%#----+@-.............................*#%%%#@....@%-.:====
======:.-@@@@@@@@@%............................:#@@@@%:.........................:**:*@@@@@@@....@%:.:===
====:.+@@%=:....-#@@**##=.......................................................:+%%%@@#..*@....@*=@@=.:==
==-::%@*:......:=*#%@@*:.......................................................:=@@@@@+...*@....@@+.-@@=.-=
==:.%@*......=*#*-:.=@@@#:...................................................:#@@@+-@%-..............*@#.:=
=-:-@@-...:*##-......+@@@@@#:............................................:=%@@@%=..:@#:..............=@%::=
=-:-@@:...++-........=@#.=#@@@@*=-:................................:-=*%@@@@#=..:-::%@=.............:%@*.-=
==::@@=.............:#@+....-+#@@@@@%#*+=-:..............:-=++*#%@@@@@@%*=:.:--===-.=@@-...........:*@%::==
==-.=@@=............*@#:.===-:..::-+#@@@@@@@@@@@@@@@@@@@@@@@@@@@%*=-::..:-=========-.-@@#-........=@@*.:-==
===-.-@@#:........=@@*:.=========-:........:::--------:::........::-=================:.=@@@@#*#%@@@#-.:====
=====:.=%@@@#**#@@@#:.:===================------::::------============================-:.:-*###*=:.:-======
=======-::-+***+=-..:-====================================================================--::::--=========
===========--::---=========================================================================================
===========================================================================================================
===========================================================================================================
"""

# --- Funzioni di supporto ---
async def mostra_scena(artwork="", messaggio="", pausa=0):
    ascii_div.innerText = artwork
    message_div.innerText = messaggio
    if pausa > 0:
        await asyncio.sleep(pausa)

async def animazione_punti(artwork, durata):
    ascii_div.innerText = artwork
    stati = ['.  ', '.. ', '...'] # Spazi per evitare salti di layout
    start_time = asyncio.get_event_loop().time()
    i = 0
    while asyncio.get_event_loop().time() - start_time < durata:
        message_div.innerText = stati[i % len(stati)]
        await asyncio.sleep(PAUSA_PUNTINI)
        i += 1

def chiudi_finestra(*args, **kwargs):
    document.getElementById("container").innerHTML = "<h1>Arrivederci!</h1>"

# --- FLUSSO PRINCIPALE ---
async def main():
    await mostra_scena(messaggio="Inizializzazione...", pausa=1)

    # Atto 0: La Grande Rivelazione
    testo_temp = ""
    for riga in RACHELE_TI_AMO_ASCII.splitlines():
        testo_temp += riga + "\n"
        ascii_div.innerText = testo_temp
        await asyncio.sleep(VELOCITA_DISEGNO)
    message_div.innerText = ""
    await asyncio.sleep(PAUSA_LENTISSIMA)

    # Atto 1: Inizio della commedia
    await mostra_scena(messaggio=MESSAGGIO_INIZIALE, pausa=PAUSA_LENTA)
    await mostra_scena(artwork=HELLO_KITTY_GESTACCIO, messaggio=MESSAGGIO_GESTACCIO_INNOCENTE, pausa=PAUSA_LENTISSIMA)

    # Atto 2: Il panico
    await animazione_punti(HELLO_KITTY_GESTACCIO, durata=PAUSA_LENTISSIMA)

    # Atto 3: La resa
    await mostra_scena(messaggio=MESSAGGIO_RESIGNATO, pausa=PAUSA_LENTA)
    await mostra_scena(artwork=HELLO_KITTY_SALUTO, messaggio=MESSAGGIO_SALUTO_FINALE, pausa=PAUSA_LENTISSIMA)
    
    # Conclusione
    await mostra_scena() # Pulisce lo schermo
    messaggio_finale_span.innerText = MESSAGGIO_FINALE_TESTO
    finale_container.style.display = "block"

# Avvia la funzione principale
asyncio.ensure_future(main())
    </py-script>

</body>
</html>
