<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Un Messaggio per Rachele</title>
    
    <!-- Importiamo PyScript -->
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>

    <!-- Stile per la console e il testo -->
    <style>
        body {
            background-color: #1e1e1e;
            color: #dcdcdc;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        #output {
            white-space: pre; /* Mantiene la formattazione del testo e degli ASCII art */
            font-size: 14px;
            line-height: 1.2;
            text-align: left;
            overflow: auto; /* Aggiunge scroll se il contenuto è troppo grande */
            max-width: 95%;
        }
        #finale-container {
            display: none; /* Nascosto all'inizio */
            margin-top: 20px;
        }
    </style>
</head>
<body>
    
    <div id="container">
        <div id="output">Inizializzazione in corso...</div>
        <div id="finale-container">
            <span id="messaggio-finale"></span>
            <button py-click="chiudi_finestra()">Premi qui per finire</button>
        </div>
    </div>

    <!-- Qui mettiamo il nostro codice Python tradotto per il web -->
    <py-script>
import asyncio
from js import document, window

# --- CONFIGURAZIONE (identica a prima) ---
NOME_DESTINATARIO = "Rachele"

# Tempistiche
PAUSA_LENTA = 3
PAUSA_LENTISSIMA = 5
VELOCITA_DISEGNO = 0.03
PAUSA_PUNTINI = 0.4

# Messaggi della storia
MESSAGGIO_INIZIALE = f"\n...e ora, un messaggio dalla nostra sponsor."
MESSAGGIO_GESTACCIO_INNOCENTE = "\nCosa c'è? Ti sto solo... fissando. Sì, esatto."
MESSAGGIO_RESIGNATO = "\nUff, e va bene! Non volevo essere scortese!"
MESSAGGIO_SALUTO_FINALE = "\nEcco, contenta adesso? Un saluto. Solo per te."
MESSAGGIO_FINALE_TESTO = "\nBene, abbiamo finito. Puoi... puoi andare ora."

# --- GRAFICA (le stringhe sono le stesse) ---
RACHELE_TI_AMO_ASCII = """
                         ,--,      ,--,                                                    ,----,       ,----,                   
        ,--,          ,---.'|   ,---.'|       ,----..                  ,--.              ,/   .`|     ,/   .`|                   
      ,--.'|    ,---,.|   | :   |   | :      /   /   \             ,--/  /|   ,---,    ,`   .'  :   ,`   .'  :                   
   ,--,  | :  ,'  .' |:   : |   :   : |     /   .     :         ,---,': / ',`--.' |  ;    ;     / ;    ;     /      ,---,        
,---.'|  : ',---.'   ||   ' :   |   ' :    .   /   ;.  \        :   : '/ / |   :  :.'___,/    ,'.'___,/    ,'      /_ ./|        
|   | : _' ||   |   .';   ; '   ;   ; '   .   ;   /  ` ;        |   '   ,  :   |  '|    :     | |    :     | ,---, |  ' :        
:   : |.'  |:   :  |-,'   | |__ '   | |__ ;   |  ; \ ; |        '   |  /   |   :  |;    |.';  ; ;    |.';  ;/___/ \.  : |        
|   ' '  ; ::   |  ;/||   | :.'||   | :.'||   :  | ; | '        |   ;  ;   '   '  ;`----'  |  | `----'  |  | .  \  \ ,' '        
'   |  .'. ||   :   .''   :    ;'   :    ;.   |  ' ' ' :        :   '   \  |   |  |    '   :  ;     '   :  ;  \  ;  `  ,'        
|   | :  | '|   |  |-,|   |  ./ |   |  ./ '   ;  \; /  |        |   |    ' '   :  ;    |   |  '     |   |  '   \  \    '         
'   : |  : ;'   :  ;/|;   : ;   ;   : ;    \   \  ',  /         '   : |.  \|   |  '    '   :  |     '   :  |    '  \   |         
|   | '  ,/ |   |    \|   ,/    |   ,/      ;   :    /          |   | '_\.''   :  |    ;   |.'      ;   |.'      \  ;  ;         
;   : ;--'  |   :   .''---'     '---'        \   \ .'           '   : |    ;   |.'     '---'        '---'         :  \  \        
|   ,/      |   | ,'                          `---`        ,---,;   |,'    '---',--,    ,--,                       \  ' ;        
'---'       `----'                                       ,--.' |'---'         ,--.'|  ,--.'|                        `--`         
                                                         |  |  :              |  | :  |  | :     ,---.                           
                 .--.--.                                 :  :  :              :  : '  :  : '    '   ,'\                          
                /  /    '    ,--.--.        .--,         :  |  |,--.   ,---.  |  ' |  |  ' |   /   /   |                         
               |  :  /`./   /       \     /_ ./|         |  :  '   |  /     \ '  | |  '  | |  .   ; ,. :                         
               |  :  ;_    .--.  .-. | , ' , ' :         |  |   /' : /    /  ||  | :  |  | :  '   | |: :                         
                \  \    `.  \__\/: . ./___/ \: |         '  :  | | |.    ' / |'  : |__'  : |__'   | .; :                         
                 `----.   \ ," .--.; | .  \  ' |         |  |  ' | :'   ;   /||  | '.'|  | '.'|   :    |                         
                /  /`--'  //  /  ,.  |  \  ;   :         |  :  :_:,''   |  / |;  :    ;  :    ;\   \  /                          
               '--'.     /;  :   .'   \  \  \  ;         |  | ,'    |   :    ||  ,   /|  ,   /  `----'                           
                 `--'---' |  ,     .-./   :  \  \        `--''       \   \  /  ---`-'  ---`-'                                    
                           `--`---'        \  ' ;                     `----'                                                     
                                            `--`                                                                                 
"""

HELLO_KITTY_GESTACCIO = """
===========================================================================================================
===========================================================================================================
===========================================================================================================
=========================================================-:::--============================================
======================================================-::-*##+-.:-=========================================
==================:.......::-========================.:*@@#++%@@+.:========--:......:-=====================
================-.:+@@@@@@#=:..:-==================-.-@@*======*@%-.===-:..:-+#@@@@@=:.-===================
===============:.-@@@*+*#%@@@@%+-..--===---:::::...:*@#=========+%@-...:=#@@@@%#**#@@%-.:==================
==============-.-@@*.......:-*@@@@#=....:-=*##%%%%%@@+===========+%@=*@@@@*=:......:#@@:.-=================
==============.:#@#............:=%@@@@@@@@@@@@@%%%@@+==============@@@@=:...........:%@%.:-================
=============-.-@@=................=%@#+.........#@*=======+%@@@@@%*@%-:.............+@@-:-================
=============-.=@@-.............................-@%=======*@%+==*@@@@@@@@#-.::::----:=@@=.-================
=============-.-@@-.............................+@#=======%@*=*@@*======+#@@@@@%%##%@@@@+.:================
=============-.:@@+.............................=@#=======#@%#@@==========+@%==========*@*.:===============
==============::*@%.............................:@%========*@@@+===========#@@*+========#%-.===============
==============-.-%@#=+-..........................=@%+========%@============#@*#@#=======%%-:===============
===============-.+@@@#:...........................-#@@%%%%%@@@@@==========+@%==#@+=====*@+.-===============
===============.:#@@=................................:::::::..=@@*=======*@%+=*@#=====*@*.:================
==============.:#@@:............................................+@@@@%@@@@*%%%#======*@#.:=================
=============:.#@%-................................................:=+#@+===========#@@@::-================
============:.*@@=....................................................:#@*========#@%*@@*.-================
===========-.-@@*.......................................................=@@%*+*@@@#:..%@@-:================
===========:.#@@:..........................................................-++=:......=@@*.-===============
===========:-%@*.......................................................................%@%-:===============
==========-.=@@=.......................................................................=@@=.-==============
=======---:.+@@:........................................................................@@*...::--=========
=-:.:------=#@@----...........--:.....................................:-:...........:--=%@%*++==---:::=====
=::*##+==+==#@@+=++-........-@@@@=...................................#@@@%:.........-==+@@%====+==**-.-====
=-:....:--:.+@@=............%@@@@@..................................=@@@@@+............:@@*:-###*:..:-=====
===========.-%@*............#@@@@@..................................-@@@@@=............=@@*##+:============
========--:..#@@=---........:%@@@-...............:---................+@@@+..........:--  #@ =======.-====
======-.-=+*##%%%++-...........:...............+@#***@*:............................=+#  #@ *##+===-======
======-.=+--:.:@@#:...........................-%#----+@-.............................*#%%% @@@@@-.:====
======:.-@@@@@@@@@%............................:#@@@@%:.........................:**:*@@@@@........@@@@==
====:.+@@%=:....-#@@**##=.......................................................:+%%%@@#............=@@=.:==
==-::%@*:......:=*#%@@*:.......................................................:=@@@@@+.............- @@=.-=
==:.%@*......=*#*-:.=@@@#:...................................................:#@@@+-@%-..............*@#.:=
=-:-@@-...:*##-......+@@@@@#:............................................:=%@@@%=..:@#:..............=@%::=
=-:-@@:...++-........=@#.=#@@@@*=-:................................:-=*%@@@@#=..:-::%@=.............:%@*.-=
==::@@=.............:#@+....-+#@@@@@%#*+=-:..............:-=++*#%@@@@@@%*=:.:--===-.=@@-...........:*@%::==
==-.=@@=............*@#:.===-:..::-+#@@@@@@@@@@@@@@@@@@@@@@@@@@@%*=-::..:-=========-.-@@#-........=@@*.:-==
===-.-@@#:........=@@*:.=========-:........:::--------:::........::-=================:.=@@@@#*#%@@@#-.:====
=====:.=%@@@#**#@@@#:.:===================------::::------============================-:.:-*###*=:.:-======
=======-::-+***+=-..:-====================================================================--::::--=========
===========--::---=========================================================================================
===========================================================================================================
===========================================================================================================
"""

HELLO_KITTY_SALUTO = """
===========================================================================================================
===========================================================================================================
===========================================================================================================
=========================================================-:::--============================================
======================================================-::-*##+-.:-=========================================
==================:.......::-========================.:*@@#++%@@+.:========--:......:-=====================
================-.:+@@@@@@#=:..:-==================-.-@@*======*@%-.===-:..:-+#@@@@@=:.-===================
===============:.-@@@*+*#%@@@@%+-..--===---:::::...:*@#=========+%@-...:=#@@@@%#**#@@%-.:==================
==============-.-@@*.......:-*@@@@#=....:-=*##%%%%%@@+===========+%@=*@@@@*=:......:#@@:.-=================
==============.:#@#............:=%@@@@@@@@@@@@@%%%@@+==============@@@@=:...........:%@%.:-================
=============-.-@@=................=%@#+.........#@*=======+%@@@@@%*@%-:.............+@@-:-================
=============-.=@@-.............................-@%=======*@%+==*@@@@@@@@#-.::::----:=@@=.-================
=============-.-@@-.............................+@#=======%@*=*@@*======+#@@@@@%%##%@@@@+.:================
=============-.:@@+.............................=@#=======#@%#@@==========+@%==========*@*.:===============
==============::*@%.............................:@%========*@@@+===========#@@*+========#%-.===============
==============-.-%@#=+-..........................=@%+========%@============#@*#@#=======%%-:===============
===============-.+@@@#:...........................-#@@%%%%%@@@@@==========+@%==#@+=====*@+.-===============
===============.:#@@=................................:::::::..=@@*=======*@%+=*@#=====*@*.:================
==============.:#@@:............................................+@@@@%@@@@*%%%#======*@#.:=================
=============:.#@%-................................................:=+#@+===========#@@@::-================
============:.*@@=....................................................:#@*========#@%*@@*.-================
===========-.-@@*.......................................................=@@%*+-..*@@@#:.%@@-:================
===========:.#@@:..........................................................-++=:......=@@*.-===============
===========:-%@*.......................................................................%@%-:===============
==========-.=@@=.......................................................................=@@=.-==============
=======---:.+@@:........................................................................@@*...::--=========
=-:.:------=#@@----...........--:.....................................:-:...........:--=%@%*++==---:::=====
=::*##+==+==#@@+=++-........-@@@@=...................................#@@@%:.........-==+@@%====+==**-.-====
=-:....:--:.+@@=............%@@@@@..................................=@@@@@+............:@@*:-###*:..:-=====
===========.-%@*............#@@@@@..................................-@@@@@=............=@@# @@@@@%::======
========--:..#@@=---........:%@@@-...............:---................+@@@+..........:--=@@#@....@@=.-====
======-.-=+*##%%%++-...........:...............+@#***@*:............................=+#  # @....@-======
======-.=+--:.:@@#:...........................-%#----+@-.............................*#%%%#@....@%-.:====
======:.-@@@@@@@@@%............................:#@@@@%:.........................:**:*@@@@@@@....@%:.:===
====:.+@@%=:....-#@@**##=.......................................................:+%%%@@#..*@....@*=@@=.:==
==-::%@*:......:=*#%@@*:.......................................................:=@@@@@+...*@....@@+.-@@=.-=
==:.%@*......=*#*-:.=@@@#:...................................................:#@@@+-@%-..............*@#.:=
=-:-@@-...:*##-......+@@@@@#:............................................:=%@@@%=..:@#:..............=@%::=
=-:-@@:...++-........=@#.=#@@@@*=-:................................:-=*%@@@@#=..:-::%@=.............:%@*.-=
==::@@=.............:#@+....-+#@@@@@%#*+=-:..............:-=++*#%@@@@@@%*=:.:--===-.=@@-...........:*@%::==
==-.=@@=............*@#:.===-:..::-+#@@@@@@@@@@@@@@@@@@@@@@@@@@@%*=-::..:-=========-.-@@#-........=@@*.:-==
===-.-@@#:........=@@*:.=========-:........:::--------:::........::-=================:.=@@@@#*#%@@@#-.:====
=====:.=%@@@#**#@@@#:.:===================------::::------============================-:.:-*###*=:.:-======
=======-::-+***+=-..:-====================================================================--::::--=========
===========--::---=========================================================================================
===========================================================================================================
===========================================================================================================
"""

# Funzioni "tradotte" per il web
output_div = document.getElementById("output")

def scrivi_su_pagina(testo):
    output_div.innerHTML = testo

async def animazione_punti(artwork, durata):
    stati = ['.', '..', '...', '....', '.....']
    start_time = asyncio.get_event_loop().time()
    i = 0
    while asyncio.get_event_loop().time() - start_time < durata:
        puntini = stati[i % len(stati)]
        scrivi_su_pagina(artwork + "\n" + puntini)
        await asyncio.sleep(PAUSA_PUNTINI)
        i += 1

def mostra_input_finale():
    scrivi_su_pagina("") # Pulisce lo schermo
    document.getElementById("messaggio-finale").innerText = MESSAGGIO_FINALE_TESTO
    document.getElementById("finale-container").style.display = "block"

def chiudi_finestra():
    # Semplicemente nasconde tutto e mostra un messaggio di addio
    document.getElementById("container").innerHTML = "<h1>Arrivederci!</h1>"

# --- FLUSSO PRINCIPALE (versione ASINCRONA per il web) ---
async def main():
    scrivi_su_pagina("") # Pulisce "Inizializzazione..."
    await asyncio.sleep(1)

    # Atto 0: La Grande Rivelazione
    testo_temp = ""
    for riga in RACHELE_TI_AMO_ASCII.splitlines():
        testo_temp += riga + "\n"
        scrivi_su_pagina(testo_temp)
        await asyncio.sleep(VELOCITA_DISEGNO)
    await asyncio.sleep(PAUSA_LENTISSIMA)

    # Atto 1: Inizio della commedia
    scrivi_su_pagina(MESSAGGIO_INIZIALE)
    await asyncio.sleep(PAUSA_LENTA)
    
    scrivi_su_pagina(HELLO_KITTY_GESTACCIO + MESSAGGIO_GESTACCIO_INNOCENTE)
    await asyncio.sleep(PAUSA_LENTISSIMA)

    # Atto 2: Il panico
    await animazione_punti(HELLO_KITTY_GESTACCIO, durata=PAUSA_LENTISSIMA)

    # Atto 3: La resa
    scrivi_su_pagina(MESSAGGIO_RESIGNATO)
    await asyncio.sleep(PAUSA_LENTA)
    
    scrivi_su_pagina(HELLO_KITTY_SALUTO + MESSAGGIO_SALUTO_FINALE)
    await asyncio.sleep(PAUSA_LENTISSIMA)

    # Conclusione con bottone
    mostra_input_finale()

# Avvia la funzione principale
asyncio.ensure_future(main())
    </py-script>

</body>
</html>